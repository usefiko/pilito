# Web Knowledge Migration Fix

## Problem
Migration 0026 was auto-generated by Django and is trying to add columns that already exist:
- `external_id`
- `external_source`

## Root Cause
The columns exist in the database but Django's migration state thinks they haven't been added yet.

## Solution

### Option 1: Fake the problematic migration (Recommended)
```bash
# Inside the container
docker exec -it <container_id> bash
python manage.py migrate web_knowledge --fake-initial

# Or specifically
python manage.py migrate web_knowledge 0025
python manage.py showmigrations web_knowledge
```

### Option 2: Mark migration as applied manually
```sql
-- Connect to PostgreSQL
INSERT INTO django_migrations (app, name, applied)
VALUES ('web_knowledge', '0026_product_external_id_product_external_source_and_more', NOW())
ON CONFLICT DO NOTHING;
```

### Option 3: Use the script
```bash
cd /Users/nima/Projects/pilito
bash fix_web_knowledge_migrations.sh
```

## Prevention
The issue occurred because:
1. Columns were added manually or in a previous migration
2. Django generated a new migration (0026) that tries to add them again
3. Migration 0025 was created with safety checks, but 0026 doesn't have them

## Verification
After fixing, verify:
```bash
docker exec -it <container_id> python manage.py showmigrations web_knowledge
docker exec -it <container_id> python manage.py migrate
```

All migrations should show `[X]` (applied).

