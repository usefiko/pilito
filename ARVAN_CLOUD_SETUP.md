# â˜ï¸ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ… Arvan Cloud Object Storage

## ğŸ“‹ Ù…Ù‚Ø¯Ù…Ù‡

Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø§Ø² **Arvan Cloud Object Storage** (Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ S3) Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§ØªÛŒÚ© Ùˆ Ù…Ø¯ÛŒØ§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

---

## ğŸ¯ Ù…Ø²Ø§ÛŒØ§ÛŒ Arvan Cloud

âœ… **Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§:** Ø³Ø±ÙˆØ±Ù‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ø§ÛŒØ±Ø§Ù† â†’ Ø³Ø±Ø¹Øª Ø¯Ø§Ù†Ù„ÙˆØ¯/Ø¢Ù¾Ù„ÙˆØ¯ Ø¨Ø³ÛŒØ§Ø± Ø¨ÛŒØ´ØªØ±  
âœ… **Ù‚ÛŒÙ…Øª Ù…Ù†Ø§Ø³Ø¨:** Ø§Ø±Ø²Ø§Ù†â€ŒØªØ± Ø§Ø² AWS S3  
âœ… **Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ S3:** Ù‡ÛŒÚ† ØªØºÛŒÛŒØ±ÛŒ Ø¯Ø± Ú©Ø¯ Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª  
âœ… **Ø¨Ø¯ÙˆÙ† ÙÛŒÙ„ØªØ±ÛŒÙ†Ú¯:** Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ VPN  
âœ… **Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ÙØ§Ø±Ø³ÛŒ:** ØªÛŒÙ… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§ÛŒØ±Ø§Ù†ÛŒ

---

## ğŸ”‘ Ø¯Ø±ÛŒØ§ÙØª Credentials

### Ù‚Ø¯Ù… 1: Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¯Ø± Arvan Cloud

1. Ø¨Ø±Ùˆ Ø¨Ù‡: https://panel.arvancloud.ir
2. Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù† ÛŒØ§ ÙˆØ§Ø±Ø¯ Ø´Ùˆ
3. Ø§Ø² Ù…Ù†ÙˆÛŒ Ø³Ù…Øª Ú†Ù¾ØŒ **Object Storage** Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†

### Ù‚Ø¯Ù… 2: Ø³Ø§Ø®Øª Bucket

1. Ø±ÙˆÛŒ **Create Bucket** Ú©Ù„ÛŒÚ© Ú©Ù†
2. ÛŒÚ© Ù†Ø§Ù… Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù† (Ù…Ø«Ù„Ø§Ù‹: `pilito-media`)
3. Ù…Ù†Ø·Ù‚Ù‡ Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†:
   - **ØªÙ‡Ø±Ø§Ù† (Tehran):** `ir-thr-at1`
   - **ØªØ¨Ø±ÛŒØ² (Tabriz):** `ir-tbz-sh1`
4. **Access Level:** Public (Ø¨Ø±Ø§ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ)

### Ù‚Ø¯Ù… 3: Ø¯Ø±ÛŒØ§ÙØª Access Keys

1. Ø¨Ø±Ùˆ Ø¨Ù‡ **Access Management**
2. Ø±ÙˆÛŒ **Create Access Key** Ú©Ù„ÛŒÚ© Ú©Ù†
3. Ø¯Ùˆ Ú©Ù„ÛŒØ¯ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†ÛŒ:
   - **Access Key:** Ù…Ø§Ù†Ù†Ø¯ `3311a374-fb35-4d06-8f90-0f67eb6520c8`
   - **Secret Key:** Ù…Ø§Ù†Ù†Ø¯ `***********************************`

âš ï¸ **Ù…Ù‡Ù…:** Secret Key ÙÙ‚Ø· ÛŒÚ©Ø¨Ø§Ø± Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´Ù‡ØŒ Ø­ØªÙ…Ø§Ù‹ Ú©Ù¾ÛŒ Ú©Ù†!

---

## âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Environment Variables

Ø¯Ø± ÙØ§ÛŒÙ„ `.env` Ø¯Ø± VPS Ø®ÙˆØ¯ Ø§ÛŒÙ† Ù…ØªØºÛŒØ±Ù‡Ø§ Ø±Ùˆ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†:

```bash
# Arvan Cloud Object Storage Configuration
AWS_ACCESS_KEY_ID=3311a374-fb35-4d06-8f90-0f67eb6520c8
AWS_SECRET_ACCESS_KEY=your-secret-key-here
AWS_STORAGE_BUCKET_NAME=pilito-media
AWS_S3_REGION_NAME=ir-thr-at1

# Arvan Cloud Endpoint (Tehran)
AWS_S3_ENDPOINT_URL=https://s3.ir-thr-at1.arvanstorage.ir
AWS_S3_CUSTOM_DOMAIN=pilito-media.s3.ir-thr-at1.arvanstorage.ir

# Ø§Ú¯Ø± Ø§Ø² Ù…Ù†Ø·Ù‚Ù‡ ØªØ¨Ø±ÛŒØ² Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒ:
# AWS_S3_ENDPOINT_URL=https://s3.ir-tbz-sh1.arvanstorage.ir
# AWS_S3_CUSTOM_DOMAIN=pilito-media.s3.ir-tbz-sh1.arvanstorage.ir
```

---

## ğŸ“ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ø¯ (Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡ âœ…)

ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø²ÛŒØ± Ø¯Ø± `src/core/settings/common.py` Ø¨Ù‡ Ø±ÙˆØ² Ø´Ø¯Ù‡:

```python
# âœ… Arvan Cloud Configuration
AWS_S3_ENDPOINT_URL = environ.get("AWS_S3_ENDPOINT_URL", "https://s3.ir-thr-at1.arvanstorage.ir")
AWS_S3_CUSTOM_DOMAIN = environ.get("AWS_S3_CUSTOM_DOMAIN", f'{AWS_STORAGE_BUCKET_NAME}.s3.ir-thr-at1.arvanstorage.ir')
```

**Ù‡ÛŒÚ† ØªØºÛŒÛŒØ± Ø¯ÛŒÚ¯Ø±ÛŒ Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª!** ğŸ‰

---

## ğŸ§ª ØªØ³Øª Configuration

### Ø¯Ø± Ù…Ø­ÛŒØ· ØªÙˆØ³Ø¹Ù‡ (Local):

```bash
# ÙØ§ÛŒÙ„ .env Ø±Ùˆ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†
nano .env

# Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†:
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_STORAGE_BUCKET_NAME=pilito-media
AWS_S3_ENDPOINT_URL=https://s3.ir-thr-at1.arvanstorage.ir
AWS_S3_CUSTOM_DOMAIN=pilito-media.s3.ir-thr-at1.arvanstorage.ir

# Ø§Ø¬Ø±Ø§ÛŒ Django
python manage.py collectstatic --noinput
python manage.py runserver
```

### Ø¯Ø± Production (VPS):

```bash
# SSH Ø¨Ù‡ VPS
ssh root@185.164.72.165

# ÙˆÛŒØ±Ø§ÛŒØ´ .env
cd /root/pilito
nano .env

# Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø¨Ø§Ù„Ø§

# Restart containers
docker-compose down
docker-compose up -d

# Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§
docker logs django_app -f
```

---

## ğŸ” Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯Ù†

### ØªØ³Øª 1: Collectstatic

```bash
docker exec django_app python manage.py collectstatic --noinput

# Ø§Ù†ØªØ¸Ø§Ø±:
# âœ… Post-processed 'xxx' files
# âœ… Copying '...' to Arvan Cloud Storage
```

### ØªØ³Øª 2: Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„

```python
# Ø¯Ø± Django shell
docker exec -it django_app python manage.py shell

from django.core.files.storage import default_storage
from django.core.files.base import ContentFile

# ØªØ³Øª Ø¢Ù¾Ù„ÙˆØ¯
path = default_storage.save('test.txt', ContentFile(b'Hello Arvan Cloud!'))
print(f"File uploaded to: {path}")
print(f"URL: {default_storage.url(path)}")

# ØªØ³Øª Ø¯Ø§Ù†Ù„ÙˆØ¯
content = default_storage.open('test.txt').read()
print(f"Content: {content}")

# Ø­Ø°Ù ÙØ§ÛŒÙ„ ØªØ³Øª
default_storage.delete('test.txt')
```

### ØªØ³Øª 3: Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ…

```bash
# Ø¨Ø±Ø±Ø³ÛŒ URL Ù‡Ø§ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§ØªÛŒÚ©
curl -I https://pilito-media.s3.ir-thr-at1.arvanstorage.ir/static/admin/css/base.css

# Ø§Ù†ØªØ¸Ø§Ø±:
# HTTP/2 200 OK
```

---

## ğŸ“Š Ù…Ù‚Ø§ÛŒØ³Ù‡ Endpoints

| Ù…Ù†Ø·Ù‚Ù‡ | Endpoint | Ø¨Ù‡ØªØ±ÛŒÙ† Ø¨Ø±Ø§ÛŒ |
|-------|----------|-------------|
| **ØªÙ‡Ø±Ø§Ù†** | `s3.ir-thr-at1.arvanstorage.ir` | Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØªÙ‡Ø±Ø§Ù† Ùˆ Ø´Ù…Ø§Ù„ |
| **ØªØ¨Ø±ÛŒØ²** | `s3.ir-tbz-sh1.arvanstorage.ir` | Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØªØ¨Ø±ÛŒØ² Ùˆ Ø´Ù…Ø§Ù„â€ŒØºØ±Ø¨ÛŒ |

ğŸ’¡ **ØªÙˆØµÛŒÙ‡:** Ø§Ø² Ù…Ù†Ø·Ù‚Ù‡ Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ± Ø¨Ù‡ Ø³Ø±ÙˆØ± VPS Ø®ÙˆØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.

---

## ğŸ› ï¸ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ

### Ù…Ø´Ú©Ù„ 1: Ø®Ø·Ø§ÛŒ 403 Forbidden

```bash
# Ø¨Ø±Ø±Ø³ÛŒ Bucket Policy Ø¯Ø± Ù¾Ù†Ù„ ArvanCloud
# Ù…Ø·Ù…Ø¦Ù† Ø´Ùˆ Ú©Ù‡ Bucket Ø±ÙˆÛŒ Public ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡
```

### Ù…Ø´Ú©Ù„ 2: ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¢Ù¾Ù„ÙˆØ¯ Ù†Ù…ÛŒâ€ŒØ´Ù†

```bash
# Ø¨Ø±Ø±Ø³ÛŒ credentials
docker exec django_app env | grep AWS

# Ø¨Ø±Ø±Ø³ÛŒ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Arvan Cloud
docker exec django_app curl -I https://s3.ir-thr-at1.arvanstorage.ir

# Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§
docker logs django_app --tail 100
```

### Ù…Ø´Ú©Ù„ 3: Static files Ù„ÙˆØ¯ Ù†Ù…ÛŒâ€ŒØ´Ù†

```bash
# Collectstatic Ù…Ø¬Ø¯Ø¯
docker exec django_app python manage.py collectstatic --noinput --clear

# Ø¨Ø±Ø±Ø³ÛŒ CORS Ø¯Ø± Ù¾Ù†Ù„ ArvanCloud
# Settings â†’ CORS â†’ Add Rule:
# - Origin: *
# - Methods: GET, HEAD
```

---

## ğŸ’° Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ (ØªÙ‚Ø±ÛŒØ¨ÛŒ)

| Ø¢ÛŒØªÙ… | Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†/Ù…Ø§Ù‡) |
|------|------------------|
| Storage 10GB | ~50,000 |
| Traffic 100GB | ~100,000 |
| Requests (100K) | ~30,000 |

ğŸ’¡ **Ù†Ú©ØªÙ‡:** Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ Ù…Ù…Ú©Ù†Ù‡ ØªØºÛŒÛŒØ± Ú©Ù†Ù‡ØŒ Ø­ØªÙ…Ø§Ù‹ Ø§Ø² Ù¾Ù†Ù„ ArvanCloud Ú†Ú© Ú©Ù†.

---

## ğŸ“š Ù…Ø³ØªÙ†Ø¯Ø§Øª

- **Arvan Cloud Docs:** https://www.arvancloud.ir/docs/object-storage
- **S3 API Compatibility:** https://docs.aws.amazon.com/AmazonS3/latest/API/
- **Django Storages:** https://django-storages.readthedocs.io/

---

## âœ… Ú†Ú©â€ŒÙ„ÛŒØ³Øª Ù†Ù‡Ø§ÛŒÛŒ

- [ ] Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¯Ø± Arvan Cloud Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡
- [ ] Bucket Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ (Public Access)
- [ ] Access Keys Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯Ù‡
- [ ] Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…Ø­ÛŒØ·ÛŒ Ø¯Ø± `.env` ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡
- [ ] Docker containers restart Ø´Ø¯Ù‡
- [ ] Collectstatic Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡
- [ ] ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§ØªÛŒÚ© Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù‡Ø³ØªÙ†Ø¯
- [ ] Ø¢Ù¾Ù„ÙˆØ¯/Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¯ÛŒØ§ ØªØ³Øª Ø´Ø¯Ù‡

---

## ğŸ‰ ØªØ¨Ø±ÛŒÚ©!

Ø­Ø§Ù„Ø§ Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ù…Ø§ Ø§Ø² **Arvan Cloud Object Storage** Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ù‡! ğŸš€

**Ù…Ø²Ø§ÛŒØ§:**
- âš¡ Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ±
- ğŸ’° Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù…ØªØ±
- ğŸ‡®ğŸ‡· Ø³Ø±ÙˆØ± Ø¯Ø§Ø®Ù„ Ø§ÛŒØ±Ø§Ù†
- ğŸ”’ Ø§Ù…Ù†ÛŒØª Ø¨Ø§Ù„Ø§

**Ø³ÙˆØ§Ù„ ÛŒØ§ Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±ÛŒØŸ** Ø¨Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ArvanCloud Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù† ÛŒØ§ Ø¨Ù‡ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù†Ú¯Ø§Ù‡ Ú©Ù†.

